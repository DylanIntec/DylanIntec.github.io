<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Journey</title>
    <script src="https://unpkg.com/scrollama"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mapbox-gl@2.15.0/dist/mapbox-gl.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/mapbox-gl@2.15.0/dist/mapbox-gl.css" rel="stylesheet">
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f0f0f0;
        }
        #map {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 1;
        }
        #scrolly {
            position: relative;
            z-index: 4;
        }
        .step {
            min-height: 80vh;
            padding: 1rem;
            margin: 0 auto;
            max-width: 600px;
        }
        .step-content {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-top: 70vh;
            position: relative;
        }
        .content-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 4px;
            margin: 1rem 0;
        }
        .overlay-images {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 3;
            pointer-events: none;
        }
        .slide-image {
            position: fixed;
            width: 40vw;
            height: 60vh;
            object-fit: cover;
            opacity: 0;
            transition: all 1.5s ease-in-out;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            border-radius: 8px;
        }
        .slide-left {
            top: 20vh;
            left: -50%;
        }
        .slide-right {
            top: 20vh;
            right: -50%;
        }
        .active .slide-left {
            left: 5%;
            opacity: 0.9;
        }
        .active .slide-right {
            right: 5%;
            opacity: 0.9;
        }
        h2 {
            margin-top: 0;
            color: #333;
        }
        p {
            line-height: 1.6;
            color: #666;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <div class="overlay-images">
        <img src="images/mystory/beach.jpeg" alt="Tasmanian Beach" class="slide-image slide-left">
        <img src="images/mystory/snow.jpg" alt="Tasmanian Snow" class="slide-image slide-right">
    </div>
    <div class="overlay-images sailing-overlay">
        <img src="images/mystory/sailing1.jpeg" alt="Sailing in Tasmania" class="slide-image slide-left">
    </div>
    <div class="overlay-images climb-overlay">
        <img src="images/mystory/johnsonsknob.jpg" alt="Climbing in Tasmania" class="slide-image slide-right">
    </div>
    <div class="overlay-images sub-overlay">
        <img src="images/mystory/SUB.JPEG" alt="Submarine" class="slide-image slide-left">
    </div>
    <div class="overlay-images defence-overlay">
        <img src="images/mystory/hld.jpg" alt="Defence" class="slide-image slide-left">
    </div>
    <div id="scrolly">
        <div class="step" data-step="1">
            <div class="step-content">
                <h2>Welcome to Australia</h2>
                <p>My story begins in Australia, a vast continent surrounded by ocean.</p>
            </div>
        </div>
        <div class="step" data-step="2">
            <div class="step-content">
                <p>Everyone knows Australia has amazing beaches but did you know you can ski there!</p>
            </div>
        </div>
        <div class="step" data-step="3">
            <div class="step-content">
                <h2>Tasmania - The Island State</h2>
                <p>Tasmania is Australia's only island state, known for its pristine wilderness, mountains, and beautiful coastlines.</p>
                <img src="images/mystory/devil.jpg" alt="Tasmanian Devil" class="content-image">
                <p>Home to unique wildlife including the iconic Tasmanian Devil - the world's largest surviving carnivorous marsupial, known for its powerful jaws and distinctive growl.</p>
            </div>
        </div>
        <div class="step" data-step="4">
            <div class="step-content">
                <h2>Growing Up in Hobart</h2>
                <p>I grew up in Hobart with a small population and surrounded by nature.</p>
            </div>
        </div>
        <div class="step" data-step="5">
            <div class="step-content">
                <h2>Sailing Adventures</h2>
                <p>The waters around Tasmania became my playground, where I developed a love for sailing.</p>
            </div>
        </div>
        <div class="step" data-step="6">
            <div class="step-content">
                <h2>Climbing</h2>
                <p>Tasmania's rugged landscape provided the perfect backdrop for rock climbing adventures.</p>
            </div>
        </div>
        <div class="step" data-step="7">
            <div class="step-content">
                <h2>Journey to University</h2>
                <p>I always knew I wanted to be an engineer but I wasn't sure which type. After reading about Naval Architecture at the Australian Maritime College, I knew combiining me love of the sea and engineering was the path for me.</p>
            </div>
        </div>
        <div class="step" data-step="7">
            <div class="step-content">
                <h2>Naval Architecture at AMC</h2>
                <p>At the Australian Maritime College, I studied naval architecture and maritime engineering, learning ship design through hands-on projects and developing skills in coding and 3D modeling.</p>
            </div>
        </div>
        <div class="step" data-step="8">
            <div class="step-content">
                <h2>Graduate job with Defence</h2>
                <p>After graduating, I wanted to work with ships that push the limits of what is possible. This lead me to a graduate job with the Australian Defence Force in Canberra, where I worked on various projects related to naval architecture and maritime engineering.</p>
            </div>
        </div>
        <div class="step" data-step="9">
            <div class="step-content">
                <p>Working at Defence gave me hands-on experience conducting ship stability tests, analyzing vessel hydrodynamics, and calcualting vessel stability.</p>
            </div>
        </div>
        <div class="step" data-step="10">
            <div class="step-content">
                <p>I enjoyed working with Defence but I knew I wanted to move to Norway with my girlfriend in the future. As Norway has a large subsea industry needed to build experience in the field. I moved to Perth where the main subsea industry is based</p>
            </div>
        </div>
        <div class="step" data-step="11">
            <div class="step-content">
                <p>I drove across Australia to Perth, a 3000km journey.</p>
            </div>
        </div>
        <div class="step" data-step="12">
            <div class="step-content">
                <p>I drove across Australia to Perth, a 3000km journey.</p>
            </div>
        </div>
    </div>

    <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoiZHlsYW52ZCIsImEiOiJja3NlYjFmdHEweWV4Mm9xcXdjOTFqbjJrIn0.--iSjd-zedbxTvz56EP61w';
        
        const map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/outdoors-v12',
            center: [133.7751, -25.2744],
            zoom: 3,
            interactive: false
        });

        // Define waypoints for the journey
        const waypoints = [
            [149.1300, -35.2809], // Canberra
            [147.3667, -35.1082], // Wagga Wagga
            [142.2181, -37.8279], // Hamilton
            [140.7852, -37.8277], // Mount Gambier
            [138.6007, -34.9285], // Adelaide
            [136.7164, -32.4959], // Port Augusta
            [134.7553, -31.9505], // Ceduna
            [131.0000, -31.9505], // Nullarbor
            [128.8000, -31.9505], // Border Village
            [125.0000, -31.9505], // Balladonia
            [121.4667, -31.9505], // Norseman
            [118.1542, -32.0397], // Southern Cross
            [115.8575, -31.9505]  // Perth
        ];

        // Function to get directions between two points
        async function getDirections(start, end) {
            const query = await fetch(
                `https://api.mapbox.com/directions/v5/mapbox/driving/${start[0]},${start[1]};${end[0]},${end[1]}?geometries=geojson&access_token=${mapboxgl.accessToken}`
            );
            const json = await query.json();
            return json.routes[0].geometry.coordinates;
        }

        // Function to get all route segments
        async function getFullRoute() {
            let allCoordinates = [];
            for (let i = 0; i < waypoints.length - 1; i++) {
                const segmentCoords = await getDirections(waypoints[i], waypoints[i + 1]);
                allCoordinates = allCoordinates.concat(segmentCoords);
            }
            return allCoordinates;
        }

        let routeCoordinates = [];

        map.on('load', async () => {
            // Get the full route when the map loads
            routeCoordinates = await getFullRoute();

            // Add the route source and layer
            map.addSource('route', {
                'type': 'geojson',
                'data': {
                    'type': 'Feature',
                    'properties': {},
                    'geometry': {
                        'type': 'LineString',
                        'coordinates': []
                    }
                }
            });

            map.addLayer({
                'id': 'route',
                'type': 'line',
                'source': 'route',
                'layout': {
                    'line-join': 'round',
                    'line-cap': 'round'
                },
                'paint': {
                    'line-color': '#ff0000',
                    'line-width': 4,
                    'line-opacity': 0.8
                }
            });
        });

        // Initialize scrollama
        const scroller = scrollama();

        // Setup the steps
        scroller.setup({
            step: '.step',
            offset: 0.5,
            progress: true
        })
        .onStepProgress(response => {
            const { element, progress } = response;
            const step = element.dataset.step;
            
            if (step === '11' && routeCoordinates.length > 0) {
                const numPoints = Math.max(2, Math.ceil(routeCoordinates.length * progress));
                const currentRoute = {
                    'type': 'Feature',
                    'geometry': {
                        'type': 'LineString',
                        'coordinates': routeCoordinates.slice(0, numPoints)
                    }
                };
                if (map.getSource('route')) {
                    map.getSource('route').setData(currentRoute);
                }
            }
        })
        .onStepEnter(response => {
            const step = response.element.dataset.step;
            
            // Handle beach/snow images animation
            if (step === '2') {
                document.querySelector('.overlay-images:not(.sailing-overlay)').classList.add('active');
            } else {
                document.querySelector('.overlay-images:not(.sailing-overlay)').classList.remove('active');
            }

            // Handle sailing image animation
            if (step === '5') {
                document.querySelector('.sailing-overlay').classList.add('active');
            } else {
                document.querySelector('.sailing-overlay').classList.remove('active');
            }
            if (step === '6') {
                document.querySelector('.climb-overlay').classList.add('active');
            } else {
                document.querySelector('.climb-overlay').classList.remove('active');
            }
            if (step === '9') {
                document.querySelector('.defence-overlay').classList.add('active');
            } else {
                document.querySelector('.defence-overlay').classList.remove('active');
            }
            if (step === '7') {
                document.querySelector('.sub-overlay').classList.add('active');
            } else {
                document.querySelector('.sub-overlay').classList.remove('active');
            }
            
            switch(step) {
                case '1':
                    map.flyTo({
                        center: [133.7751, -25.2744], // Australia center
                        zoom: 3,
                        duration: 3000
                    });
                    break;
                case '2':
                    // Keep the Australia view while showing images
                    break;
                case '3':
                    map.flyTo({
                        center: [146.5, -42], // Tasmania center
                        zoom: 7,
                        duration: 5000
                    });
                    break;
                case '4':
                    map.flyTo({
                        center: [147.3272, -42.8821], // Hobart
                        zoom: 12,
                        duration: 5000
                    });
                    break;
                case '7':
                    map.flyTo({
                        center: [147.1345, -41.4419], // Launceston
                        zoom: 12,
                        duration: 8000
                    });
                    break;
                case '8':
                    map.flyTo({
                        center: [149.1300, -35.2809], // Canberra
                        zoom: 11,
                        duration: 8000
                    });
                    break;
                case '10':
                    map.flyTo({
                        center: [133.7751, -25.2744], // Australia center
                        zoom: 4,
                        duration: 3000
                    });
                    // Update route coordinates to be more detailed
                    const routeData = {
                        'type': 'Feature',
                        'geometry': {
                            'type': 'LineString',
                            'coordinates': [
                                [149.1300, -35.2809], // Canberra
                                [147.3667, -35.1082], // Wagga Wagga
                                [144.9631, -37.8136], // Melbourne
                                [142.2181, -37.8279], // Hamilton
                                [140.7852, -37.8277], // Mount Gambier
                                [138.6007, -34.9285], // Adelaide
                                [136.7164, -32.4959], // Port Augusta
                                [134.7553, -31.9505], // Ceduna
                                [131.0000, -31.9505], // Nullarbor
                                [128.8000, -31.9505], // Border Village
                                [125.0000, -31.9505], // Balladonia
                                [121.4667, -31.9505], // Norseman
                                [118.1542, -32.0397], // Southern Cross
                                [115.8575, -31.9505]  // Perth
                            ]
                        }
                    };
                    
                    if (map.getSource('route')) {
                        map.getSource('route').setData({
                            'type': 'Feature',
                            'geometry': {
                                'type': 'LineString',
                                'coordinates': []
                            }
                        });
                    }
                    break;
            }
        })
        .onStepExit(response => {
            const nextStep = response.direction === 'down' ? response.index + 2 : response.index;
            if (nextStep === 2) {
                document.querySelector('.overlay-images').classList.remove('active');
            }
        });

        // Handle window resize
        window.addEventListener('resize', scroller.resize);
    </script>
</body>
</html> 